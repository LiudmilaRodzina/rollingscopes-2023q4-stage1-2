var U=Object.defineProperty;var I=(i,t,e)=>t in i?U(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var d=(i,t,e)=>(I(i,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();class h{constructor(t={tag:"",classNames:[],textContent:""}){d(this,"element");this.element=null,this.createElement(t)}createElement(t){this.element=document.createElement(t.tag),this.setCssClasses(t.classNames),this.setTextContent(t.textContent)}setCssClasses(t){t.forEach(e=>{this.element&&this.element.classList.add(e)})}setTextContent(t){this.element&&(this.element.textContent=t)}getElement(){return this.element}}const M="ENGLISH PUZZLE",w="Welcome, ",B="Click on words, collect phrases. Words can be dragged and dropped. Select tooltips in the menu",y="Start Game",O="Logout",_="Sorry, we are experiencing technical difficulties. Please try again later",L="off",P="button",b="input",v=3,G=4,c={USER_GREETING:"user-greeting",LOGIN_CONTAINER:"login-container",CONTENT_CONTAINER:"content-container",START_SCREEN_CONTAINER:"start-screen-container",GAME_CONTAINER:"game-container",BUTTON_LOGIN:"button-login",BUTTON_LOGOUT:"button-logout",BUTTON_START:"button-start",INPUT_FIELD:"input-field",INPUT_LABEL:"input-label",ERROR_MESSAGE_CLASS:"error-message"},o={CONTAINER:"div",FORM:"form",BUTTON:"button",INPUT:"input",LABEL:"label",PARAGRAPH:"p",SPAN:"span"},T={NAME:"Name:",SURNAME:"Surname:",LOGIN:"Login",BLANK:""},g={NAME:"name"},u={NAME:"first-name",SURNAME:"surname",BLANK:""},S={GAME:"game",START:"start"};class x extends h{constructor(){super({tag:o.FORM,classNames:[c.LOGIN_CONTAINER],textContent:""}),this.createLoginView()}addElement(t,e,n,s,r=""){const l={tag:t,textContent:e,classNames:s},A=new h(l),p=this.getElement();if(p&&(p.append(A.getElement()),t===o.INPUT)){const f=A.getElement();f.name=n,r&&f.setAttribute("autocomplete",r)}}createLoginView(){var n;this.addElement(o.LABEL,T.NAME,u.BLANK,[c.INPUT_LABEL]),this.addElement(o.INPUT,T.BLANK,u.NAME,[c.INPUT_FIELD],L),this.addElement(o.LABEL,T.SURNAME,u.BLANK,[c.INPUT_LABEL]),this.addElement(o.INPUT,T.BLANK,u.SURNAME,[c.INPUT_FIELD],L);const e=new h({tag:o.BUTTON,textContent:T.LOGIN,classNames:[c.BUTTON_LOGIN]}).getElement();e.disabled=!0,(n=this.getElement())==null||n.append(e)}}var m=(i=>(i.Capitalization="Please start with a capitalized Latin letter",i.CharacterRestriction="Please enter only Latin letters and the hyphen (-) symbol",i.LengthRestrictionName="First name must be at least 3 characters long",i.LengthRestrictionSurname="Surname must be at least 4 characters long",i))(m||{});const E=class E{static saveUserData(t){E.validateUserData(t)&&localStorage.setItem(E.USER_DATA_KEY,JSON.stringify(t))}static validateUserData(t){return t&&Object.values(t).every(e=>e.trim()!=="")}static removeUserData(){localStorage.removeItem(E.USER_DATA_KEY)}static getUserData(){const t=localStorage.getItem(E.USER_DATA_KEY)||"{}";return JSON.parse(t)}};d(E,"USER_DATA_KEY","userData");let N=E;class C extends h{constructor(){super({tag:o.CONTAINER,classNames:[c.GAME_CONTAINER],textContent:""}),this.addContent(),this.addLogoutButton()}addContent(){var e;const t=document.createElement(o.PARAGRAPH);t.textContent=_,(e=this.getElement())==null||e.append(t)}addLogoutButton(){var e;const t=document.createElement(o.BUTTON);t.textContent=O,t.classList.add(c.BUTTON_LOGOUT),t.addEventListener("click",()=>{N.removeUserData();const s=window.location.pathname.split("/").slice(0,-1).join("/");window.location.href=`${window.location.origin}${s}/`}),(e=this.getElement())==null||e.append(t)}}class R extends h{constructor(){super({tag:o.CONTAINER,classNames:[c.START_SCREEN_CONTAINER],textContent:""}),this.addContent(),this.addStartButton(),this.addLogoutButton()}addContent(){var A;const t=document.createElement(o.PARAGRAPH);t.textContent=M;const e=document.createElement(o.SPAN),n=N.getUserData(),s=`${n.name} ${n.surname}`;e.textContent=`${w} ${s}!`,e.classList.add(c.USER_GREETING);const r=document.createElement(o.SPAN);r.textContent=B;const l=document.createElement(o.CONTAINER);l.classList.add(c.CONTENT_CONTAINER),l.append(t,e,r),(A=this.getElement())==null||A.append(l)}addStartButton(){var e;const t=document.createElement(o.BUTTON);t.textContent=y,t.classList.add(c.BUTTON_START),t.addEventListener("click",()=>{window.location.hash=S.GAME;const n=new C;document.body.innerHTML="",document.body.append(n.getElement())}),(e=this.getElement())==null||e.append(t)}addLogoutButton(){var e;const t=document.createElement(o.BUTTON);t.textContent=O,t.classList.add(c.BUTTON_LOGOUT),t.addEventListener("click",()=>{N.removeUserData();const s=window.location.pathname.split("/").slice(0,-1).join("/");window.location.href=`${window.location.origin}${s}/`}),(e=this.getElement())==null||e.append(t)}}class a{constructor(t,e,n){d(this,"formElement");d(this,"loginButton");d(this,"allInputs");this.formElement=t,this.loginButton=this.formElement.querySelector(e),this.allInputs=Array.from(this.formElement.querySelectorAll(n))}setupValidation(){this.loginButton&&(this.loginButton.addEventListener("click",()=>{const t=this.getUserDataFromInputs();t&&N.saveUserData(t),a.displayStartScreenView()}),this.allInputs.forEach(t=>{t.addEventListener("input",()=>{this.validateEmptyInputs(),a.validateUppercaseFirstLetter(t),this.validateCharacterRestriction(t),a.validateMinimumLength(t)}),t.tagName===o.INPUT&&t.setAttribute("required","true")}))}validateEmptyInputs(){const t=this.allInputs.every(e=>e.value.trim()!==""&&a.validateUppercaseFirstLetter(e)&&this.validateCharacterRestriction(e)&&a.validateMinimumLength(e));this.loginButton&&(this.loginButton.disabled=!t)}static isFirstLetterUppercase(t){const e=t.value.trim().charAt(0);return/^[A-Z]/.test(e)}static validateUppercaseFirstLetter(t){if(!a.isFirstLetterUppercase(t)){const e=m.Capitalization;return a.showErrorMessage(t,e),!1}return!0}validateCharacterRestriction(t){if(!/^[a-zA-Z-]*$/.test(t.value)){const n=m.CharacterRestriction;return this.hideAllErrorMessages(t),a.showErrorMessage(t,n),!1}return a.hideErrorMessage(t),!0}static validateMinimumLength(t){const e=t.getAttribute(g.NAME),n=e===u.NAME?v:G,s=t.nextElementSibling;if(s&&s.className===c.ERROR_MESSAGE_CLASS)return!0;if(!a.isFirstLetterUppercase(t)){const r=m.Capitalization;return a.hideErrorMessage(t),a.showErrorMessage(t,r),!1}if(t.value.length<n){const r=e===u.NAME?m.LengthRestrictionName:m.LengthRestrictionSurname;return a.showErrorMessage(t,r),!1}return a.hideErrorMessage(t),!0}static showErrorMessage(t,e){const n=t.nextElementSibling;if(!n||n.className!==c.ERROR_MESSAGE_CLASS){const s=document.createElement(o.SPAN);s.className=c.ERROR_MESSAGE_CLASS,s.textContent=e,t.insertAdjacentElement("afterend",s)}}static hideErrorMessage(t){const e=t.nextElementSibling;e&&e.className===c.ERROR_MESSAGE_CLASS&&e.remove()}hideAllErrorMessages(t){this.allInputs.forEach(e=>{a.skipErrorHiding(t,e)||a.hideErrorMessage(e)})}static skipErrorHiding(t,e){return e===t?!1:t.getAttribute(g.NAME)!==e.getAttribute(g.NAME)}getUserDataFromInputs(){const t={};return this.allInputs.forEach(e=>{const n=e.getAttribute(g.NAME),s=e.value.trim();n&&s&&(t[n]=s)}),Object.keys(t).length>0?t:null}static displayStartScreenView(){const e=new R().getElement();e&&(window.history.pushState(null,"",`#${S.START}`),document.body.innerHTML="",document.body.append(e))}static stayLoggedInOnLoad(){document.addEventListener("DOMContentLoaded",()=>{const{hash:t}=window.location;if(t===`#${S.START}`){const n=new R().getElement();n&&(document.body.innerHTML="",document.body.append(n))}if(t===`#${S.GAME}`){const n=new C().getElement();n&&(document.body.innerHTML="",document.body.append(n))}})}}class D{static createView(){const t=new x,e=document.body;if(e){e.append(t.getElement());const n=t.getElement();new a(n,P,b).setupValidation()}a.stayLoggedInOnLoad()}}class V{constructor(){D.createView()}}new V;
